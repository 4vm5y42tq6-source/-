<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Hours</title>

<style>
body {
  margin:0;
  font-family: system-ui;
  background:#f2f2f2;
}
header {
  background:#ffffff;
  padding:14px;
  text-align:center;
  font-size:20px;
  font-weight:bold;
}
.box {
  background:#fff;
  margin:12px;
  padding:12px;
  border-radius:12px;
}
button {
  width:100%;
  padding:14px;
  font-size:18px;
  border:none;
  border-radius:12px;
}
#getBtn {
  background:#bbb;
  color:white;
}
.active {
  background:#2e7dff !important;
}
.tab button {
  width:24%;
}
.monster {
  display:flex;
  gap:10px;
  margin-bottom:12px;
}
.monster img {
  width:72px;
  height:72px;
  border-radius:10px;
}
.small {
  font-size:12px;
  color:#666;
}
</style>
</head>

<body>

<header>The Hours</header>

<div class="box">
ğŸ’° é‡‘è²¨ï¼š<span id="gold">0</span><br>
â± åç›Šï¼š<span id="income">0</span>/ç§’
</div>

<div class="box">
æ¬¡ã®GETã¾ã§<br>
<b id="timer">--:--</b>
<button id="getBtn">GETã™ã‚‹</button>
</div>

<div class="box tab">
<button onclick="showTab('warehouse')">å€‰åº«</button>
<button onclick="showTab('set')">ã‚»ãƒƒãƒˆ</button>
<button onclick="showTab('dex')">å›³é‘‘</button>
<button onclick="showTab('help')">èª¬æ˜</button>
</div>

<div class="box" id="content"></div>

<script>
const monsterDB = [
 {name:"ã‚¹ãƒ©ã‚¤ãƒ ", img:"images/slime.png", base:1},
 {name:"ãƒ¬ãƒƒãƒ‰ã‚¹ãƒ©ã‚¤ãƒ ", img:"images/red_slime.png", base:2},
 {name:"ãƒ‰ãƒ©ã‚­ãƒ¼", img:"images/dracky.png", base:3},
 {name:"ã‚´ãƒ–ãƒªãƒ³", img:"images/goblin.png", base:4},
 {name:"ã‚­ãƒ¡ãƒ©", img:"images/chimera.png", base:6},
 {name:"ã‚´ãƒ¼ãƒ¬ãƒ ", img:"images/golem.png", base:8},
 {name:"ãƒ‰ãƒ©ã‚´ãƒ³", img:"images/dragon.png", base:15, rare:true},
 {name:"ãƒ¡ã‚¿ãƒ«ã‚¹ãƒ©ã‚¤ãƒ ", img:"images/metal_slime.png", base:25, rare:true}
];

let data = JSON.parse(localStorage.getItem("hours")) || {
 gold:0,
 monsters:[],
 set:null,
 lastGet:0,
 lastTime:Date.now()
};

function save(){ localStorage.setItem("hours",JSON.stringify(data)); }

function updateIncome(){
 if(!data.set){ income.textContent=0; return; }
 income.textContent = data.set.power.toFixed(1);
}

function tick(){
 const now = Date.now();
 const diff = (now - data.lastTime)/1000;
 if(data.set){
   data.gold += diff * data.set.power;
 }
 data.lastTime = now;
 gold.textContent = Math.floor(data.gold);
 save();
}
setInterval(tick,1000);

function updateTimer(){
 const remain = 3600000 - (Date.now() - data.lastGet);
 if(remain<=0){
   timer.textContent="GETå¯èƒ½";
   getBtn.classList.add("active");
 } else {
   const m = Math.floor(remain/60000);
   const s = Math.floor((remain%60000)/1000);
   timer.textContent=`${m}:${s.toString().padStart(2,"0")}`;
 }
}
setInterval(updateTimer,1000);

getBtn.onclick = ()=>{
 if(Date.now()-data.lastGet < 3600000) return;

 const m = monsterDB[Math.floor(Math.random()*monsterDB.length)];
 const iv = Math.floor(Math.random()*100)+1;
 const color = ["é’","èµ¤","é‡‘","éŠ€"][Math.floor(Math.random()*4)];
 let power = m.base * iv;

 if(color==="é‡‘") power*=2;
 if(color==="éŠ€") power*=1.5;
 if(m.rare) power*=3;

 data.monsters.push({
  ...m,
  iv,
  color,
  power
 });

 data.lastGet = Date.now();
 save();
 alert(`${m.name}ã‚’GETï¼`);
};

function showTab(tab){
 const c = content;
 c.innerHTML="";

 if(tab==="warehouse"){
   data.monsters.forEach((m,i)=>{
     const d=document.createElement("div");
     d.className="monster";
     d.innerHTML=`
     <img src="${m.img}">
     <div>
     <b>${m.color} ${m.name}</b><br>
     å€‹ä½“å€¤:${m.iv}<br>
     åç›Š:${m.power.toFixed(1)}<br>
     <button onclick="setMonster(${i})">ã‚»ãƒƒãƒˆ</button>
     </div>`;
     c.appendChild(d);
   });
 }

 if(tab==="set"){
   c.innerHTML = data.set
    ? `<b>${data.set.color} ${data.set.name}</b><br>åç›Š:${data.set.power.toFixed(1)}`
    : "æœªã‚»ãƒƒãƒˆ";
 }

 if(tab==="dex"){
   monsterDB.forEach(m=>{
     c.innerHTML += `<div>${m.name}${m.rare?" ğŸŒŸ":""}</div>`;
   });
 }

 if(tab==="help"){
   c.innerHTML = `
   ãƒ»1æ™‚é–“ã«1å›GET<br>
   ãƒ»å€‰åº«ã¯ç„¡é™<br>
   ãƒ»ã‚»ãƒƒãƒˆä¸­ã®ã¿åç›Šç™ºç”Ÿ<br>
   ãƒ»ãƒ¬ã‚¢ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã¯è¶…é«˜åç›Š<br>
   ãƒ»ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ä¸­ã‚‚åç›ŠãŒè²¯ã¾ã‚‹
   `;
 }
}

function setMonster(i){
 data.set = data.monsters[i];
 updateIncome();
 save();
 alert("ã‚»ãƒƒãƒˆå®Œäº†ï¼");
}

updateIncome();
showTab("warehouse");
</script>

</body>
</html>
