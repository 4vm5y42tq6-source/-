<script>
let coin = 0;
let slime = 0;
let goblin = 0;
let dragon = 0;

// æœ€å¾Œã«ãƒ©ãƒ³ãƒ€ãƒ GETã—ãŸæ™‚åˆ»ï¼ˆä¿å­˜ï¼‰
let lastGet = localStorage.getItem("lastGet");
if (!lastGet) lastGet = 0;

const symbols = ["ðŸŸ¢","ðŸŸ¤","ðŸ”´"];

// =====================
// æ”¾ç½®åŽå…¥
// =====================
setInterval(() => {
  let power = slime * 1 + goblin * 5 + dragon * 20;
  coin += power;
  update();
  updateTimer();
}, 1000);

// =====================
// ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼è³¼å…¥
// =====================
function buySlime() {
  if (coin >= 10) { coin -= 10; slime++; update(); }
}
function buyGoblin() {
  if (coin >= 50) { coin -= 50; goblin++; update(); }
}
function buyDragon() {
  if (coin >= 200) { coin -= 200; dragon++; update(); }
}

// =====================
// 1æ™‚é–“1å›žãƒ©ãƒ³ãƒ€ãƒ GET
// =====================
function randomGet() {
  const now = Date.now();
  if (now - lastGet < 3600000) return;

  const r = Math.random();

  if (r < 0.6) {
    slime++;
    alert("ðŸŸ¢ ã‚¹ãƒ©ã‚¤ãƒ ãŒä»²é–“ã«ãªã£ãŸï¼");
  } else if (r < 0.9) {
    goblin++;
    alert("ðŸŸ¤ ã‚´ãƒ–ãƒªãƒ³ãŒä»²é–“ã«ãªã£ãŸï¼");
  } else {
    dragon++;
    alert("ðŸ”´ ãƒ‰ãƒ©ã‚´ãƒ³ãŒä»²é–“ã«ãªã£ãŸï¼ï¼ï¼");
  }

  lastGet = now;
  localStorage.setItem("lastGet", lastGet);
  update();
}

// =====================
// æ®‹ã‚Šæ™‚é–“è¡¨ç¤º
// =====================
function updateTimer() {
  const now = Date.now();
  const diff = 3600000 - (now - lastGet);

  const timer = document.getElementById("timer");
  const btn = document.getElementById("randomBtn");

  if (diff <= 0) {
    timer.textContent = "ä»Šã™ãGETã§ãã‚‹ï¼";
    btn.disabled = false;
  } else {
    const min = Math.ceil(diff / 60000);
    timer.textContent = "æ¬¡ã®GETã¾ã§ " + min + " åˆ†";
    btn.disabled = true;
  }
}

// =====================
// è¡¨ç¤ºæ›´æ–°
// =====================
function update() {
  document.getElementById("coin").textContent = coin;
  document.getElementById("slime").textContent = slime;
  document.getElementById("goblin").textContent = goblin;
  document.getElementById("dragon").textContent = dragon;
  document.getElementById("power").textContent =
    slime * 1 + goblin * 5 + dragon * 20;
}
</script>
