<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Hours</title>
<style>
body {
  font-family: system-ui;
  background:#f5f5f5;
  margin:0;
}
header {
  background:#fff;
  padding:12px;
  text-align:center;
  font-weight:bold;
}
.box {
  background:#fff;
  margin:12px;
  padding:12px;
  border-radius:12px;
}
button {
  width:100%;
  padding:14px;
  font-size:18px;
  border:none;
  border-radius:12px;
}
#getBtn {
  background:#ccc;
  color:#fff;
}
.active {
  background:#2e7dff !important;
}
.monster {
  display:flex;
  gap:10px;
  margin-bottom:10px;
  align-items:center;
}
.monster img {
  width:64px;
  height:64px;
  border-radius:8px;
  background:#eee;
}
.small {
  font-size:12px;
  color:#666;
}
.tab button {
  width:24%;
}
</style>
</head>
<body>

<header>The hours</header>

<div class="box">
  ğŸ’° é‡‘è²¨: <span id="gold">0</span><br>
  â± åç›Š: <span id="income">0</span>/ç§’
</div>

<div class="box">
  æ¬¡ã®GETã¾ã§<br>
  <b id="timer">--:--</b>
  <button id="getBtn">GETã™ã‚‹</button>
</div>

<div class="box tab">
  <button onclick="showTab('warehouse')">å€‰åº«</button>
  <button onclick="showTab('set')">ã‚»ãƒƒãƒˆ</button>
  <button onclick="showTab('dex')">å›³é‘‘</button>
  <button onclick="showTab('help')">èª¬æ˜</button>
</div>

<div class="box" id="content"></div>

<script>
const monsters = [
  {name:"ã‚¹ãƒ©ã‚¤ãƒ ", img:"https://i.imgur.com/7yUvePI.png", base:1},
  {name:"ã‚´ãƒ–ãƒªãƒ³", img:"https://i.imgur.com/vH1yH7P.png", base:2},
  {name:"ãƒ‰ãƒ©ã‚­ãƒ¼", img:"https://i.imgur.com/7dM7N5T.png", base:3},
  {name:"ãƒ•ã‚§ãƒ‹ãƒƒã‚¯ã‚¹", img:"https://i.imgur.com/F7cZ2xN.png", base:8, rare:true},
  {name:"è¦šé†’ã‚¹ãƒ©ã‚¤ãƒ ", img:"https://i.imgur.com/VnQ9QpB.png", base:12, rare:true}
];

let data = JSON.parse(localStorage.getItem("hours")) || {
  gold:0,
  monsters:[],
  set:null,
  lastGet:0,
  lastTime:Date.now()
};

function save(){
  localStorage.setItem("hours",JSON.stringify(data));
}

function updateIncome(){
  if(!data.set){ document.getElementById("income").textContent=0; return;}
  document.getElementById("income").textContent = data.set.power.toFixed(1);
}

function tick(){
  const now = Date.now();
  const diff = (now - data.lastTime)/1000;
  if(data.set){
    data.gold += diff * data.set.power;
  }
  data.lastTime = now;
  document.getElementById("gold").textContent = Math.floor(data.gold);
  save();
}
setInterval(tick,1000);

function updateTimer(){
  const remain = 3600000 - (Date.now() - data.lastGet);
  if(remain<=0){
    document.getElementById("timer").textContent="GETå¯èƒ½";
    document.getElementById("getBtn").classList.add("active");
  } else {
    const m = Math.floor(remain/60000);
    const s = Math.floor((remain%60000)/1000);
    document.getElementById("timer").textContent=`${m}:${s.toString().padStart(2,"0")}`;
  }
}
setInterval(updateTimer,1000);

document.getElementById("getBtn").onclick=()=>{
  if(Date.now()-data.lastGet<3600000) return;
  const m = monsters[Math.floor(Math.random()*monsters.length)];
  const iv = Math.floor(Math.random()*100)+1;
  const color = ["é’","èµ¤","é‡‘","éŠ€"][Math.floor(Math.random()*4)];
  const power = m.base * iv * (m.rare?3:1) * (color=="é‡‘"?2:color=="éŠ€"?1.5:1);
  data.monsters.push({...m,iv,color,power});
  data.lastGet = Date.now();
  save();
  alert(`${m.name}ã‚’GETï¼`);
};

function showTab(t){
  const c = document.getElementById("content");
  c.innerHTML="";
  if(t=="warehouse"){
    data.monsters.forEach((m,i)=>{
      const d=document.createElement("div");
      d.className="monster";
      d.innerHTML=`<img src="${m.img}">
      <div>
      <b>${m.color} ${m.name}</b><br>
      å€‹ä½“å€¤:${m.iv}<br>
      åç›Š:${m.power.toFixed(1)}
      <button onclick="setMonster(${i})">ã‚»ãƒƒãƒˆ</button>
      </div>`;
      c.appendChild(d);
    });
  }
  if(t=="set"){
    c.innerHTML = data.set ? 
      `ã‚»ãƒƒãƒˆä¸­:<br><b>${data.set.name}</b>` : "æœªã‚»ãƒƒãƒˆ";
  }
  if(t=="dex"){
    monsters.forEach(m=>{
      c.innerHTML+=`<div>${m.name}</div>`;
    });
  }
  if(t=="help"){
    c.innerHTML=`
    ãƒ»1æ™‚é–“ã«1å›GET<br>
    ãƒ»ã‚»ãƒƒãƒˆã—ãŸãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã ã‘åç›Š<br>
    ãƒ»ãƒ¬ã‚¢ã¯è¶…å¼·ã„<br>
    ãƒ»å€‰åº«ã¯ç„¡é™<br>
    `;
  }
}

function setMonster(i){
  data.set = data.monsters[i];
  updateIncome();
  save();
  alert("ã‚»ãƒƒãƒˆã—ã¾ã—ãŸï¼");
}

updateIncome();
showTab("warehouse");
</script>

</body>
</html>
